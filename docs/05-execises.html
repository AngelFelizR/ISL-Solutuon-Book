<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.2.269">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Angel Feliz">
<title>An Introduction to Statistical Learning (Non Official Solution Book) - 05 - Resampling Methods</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1.6em;
  vertical-align: middle;
}
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { color: #008000; } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { color: #008000; font-weight: bold; } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./11-execises.html" rel="next">
<link href="./04-execises.html" rel="prev">
<link href="./cover.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit"
  }
}</script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>
</head>
<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">An Introduction to Statistical Learning (Non Official Solution Book)</span>
    </a>
  </div>
          <div class="quarto-toggle-container ms-auto">
              <a href="" class="quarto-reader-toggle nav-link" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
          </div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }"><div class="container-fluid d-flex justify-content-between">
      <h1 class="quarto-secondary-nav-title">05 - Resampling Methods</h1>
      <button type="button" class="quarto-btn-toggle btn" aria-label="Show secondary navigation">
        <i class="bi bi-chevron-right"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse sidebar-navigation floating overflow-auto"><div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
      </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">Preface</a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">Teorical Summary</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modeling-process.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Strategy to implement machine learning solutions</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missing-values.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Dealing with missingness</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-performance.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Understanding model performance</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./resampling-methods.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Resampling methods</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./generalized-linear-models.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Generalized linear models (GLM)</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./generative-classification-models.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Generative Models for Classiﬁcation</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./flexible-regression.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Flexible Regression Models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./non-parametric-models.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Non-parametric Methods</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./survival-analysis.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Time-event (Survival) Analysis and Censored Data</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./unsupervised-learning.html" class="sidebar-item-text sidebar-link"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Unsupervised Learning</span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">Exercise Solutions</a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-execises.html" class="sidebar-item-text sidebar-link">02 - Statistical Learning</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-execises.html" class="sidebar-item-text sidebar-link">03 - Linear Regression</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-execises.html" class="sidebar-item-text sidebar-link">04 - Classification</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-execises.html" class="sidebar-item-text sidebar-link active">05 - Resampling Methods</a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-execises.html" class="sidebar-item-text sidebar-link">11 - Survival Analysis and Censored Data</a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><!-- margin-sidebar --><div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#libraries" id="toc-libraries" class="nav-link active" data-scroll-target="#libraries">Libraries</a></li>
  <li>
<a href="#conceptual" id="toc-conceptual" class="nav-link" data-scroll-target="#conceptual">Conceptual</a>
  <ul>
<li><a href="#section" id="toc-section" class="nav-link" data-scroll-target="#section">1</a></li>
  <li>
<a href="#section-1" id="toc-section-1" class="nav-link" data-scroll-target="#section-1">2</a>
  <ul class="collapse">
<li><a href="#a" id="toc-a" class="nav-link" data-scroll-target="#a">A</a></li>
  <li><a href="#b" id="toc-b" class="nav-link" data-scroll-target="#b">B</a></li>
  <li><a href="#c" id="toc-c" class="nav-link" data-scroll-target="#c">C</a></li>
  <li><a href="#d" id="toc-d" class="nav-link" data-scroll-target="#d">D</a></li>
  <li><a href="#e" id="toc-e" class="nav-link" data-scroll-target="#e">E</a></li>
  <li><a href="#f" id="toc-f" class="nav-link" data-scroll-target="#f">F</a></li>
  <li><a href="#g" id="toc-g" class="nav-link" data-scroll-target="#g">G</a></li>
  <li><a href="#h" id="toc-h" class="nav-link" data-scroll-target="#h">H</a></li>
  </ul>
</li>
  <li>
<a href="#section-2" id="toc-section-2" class="nav-link" data-scroll-target="#section-2">3</a>
  <ul class="collapse">
<li><a href="#a-1" id="toc-a-1" class="nav-link" data-scroll-target="#a-1">A</a></li>
  <li><a href="#b-1" id="toc-b-1" class="nav-link" data-scroll-target="#b-1">B</a></li>
  </ul>
</li>
  <li><a href="#section-3" id="toc-section-3" class="nav-link" data-scroll-target="#section-3">4</a></li>
  </ul>
</li>
  <li>
<a href="#applied" id="toc-applied" class="nav-link" data-scroll-target="#applied">Applied</a>
  <ul>
<li>
<a href="#section-4" id="toc-section-4" class="nav-link" data-scroll-target="#section-4">5</a>
  <ul class="collapse">
<li><a href="#a-2" id="toc-a-2" class="nav-link" data-scroll-target="#a-2">A</a></li>
  <li><a href="#b-2" id="toc-b-2" class="nav-link" data-scroll-target="#b-2">B</a></li>
  <li><a href="#c-1" id="toc-c-1" class="nav-link" data-scroll-target="#c-1">C</a></li>
  <li><a href="#d-1" id="toc-d-1" class="nav-link" data-scroll-target="#d-1">D</a></li>
  </ul>
</li>
  <li>
<a href="#section-5" id="toc-section-5" class="nav-link" data-scroll-target="#section-5">6</a>
  <ul class="collapse">
<li><a href="#a-3" id="toc-a-3" class="nav-link" data-scroll-target="#a-3">A</a></li>
  <li><a href="#b-3" id="toc-b-3" class="nav-link" data-scroll-target="#b-3">B</a></li>
  <li><a href="#c-2" id="toc-c-2" class="nav-link" data-scroll-target="#c-2">C</a></li>
  <li><a href="#d-2" id="toc-d-2" class="nav-link" data-scroll-target="#d-2">D</a></li>
  </ul>
</li>
  <li>
<a href="#section-6" id="toc-section-6" class="nav-link" data-scroll-target="#section-6">7</a>
  <ul class="collapse">
<li><a href="#a-4" id="toc-a-4" class="nav-link" data-scroll-target="#a-4">A</a></li>
  <li><a href="#b-4" id="toc-b-4" class="nav-link" data-scroll-target="#b-4">B</a></li>
  <li><a href="#c-3" id="toc-c-3" class="nav-link" data-scroll-target="#c-3">C</a></li>
  <li><a href="#d-3" id="toc-d-3" class="nav-link" data-scroll-target="#d-3">D</a></li>
  <li><a href="#e-1" id="toc-e-1" class="nav-link" data-scroll-target="#e-1">E</a></li>
  </ul>
</li>
  <li>
<a href="#section-7" id="toc-section-7" class="nav-link" data-scroll-target="#section-7">8</a>
  <ul class="collapse">
<li><a href="#a-5" id="toc-a-5" class="nav-link" data-scroll-target="#a-5">A</a></li>
  <li><a href="#b-5" id="toc-b-5" class="nav-link" data-scroll-target="#b-5">B</a></li>
  <li><a href="#c-4" id="toc-c-4" class="nav-link" data-scroll-target="#c-4">C</a></li>
  <li><a href="#d-4" id="toc-d-4" class="nav-link" data-scroll-target="#d-4">D</a></li>
  <li><a href="#e-2" id="toc-e-2" class="nav-link" data-scroll-target="#e-2">E</a></li>
  <li><a href="#f-1" id="toc-f-1" class="nav-link" data-scroll-target="#f-1">F</a></li>
  </ul>
</li>
  <li>
<a href="#section-8" id="toc-section-8" class="nav-link" data-scroll-target="#section-8">9</a>
  <ul class="collapse">
<li><a href="#a-6" id="toc-a-6" class="nav-link" data-scroll-target="#a-6">A</a></li>
  <li><a href="#b-6" id="toc-b-6" class="nav-link" data-scroll-target="#b-6">B</a></li>
  <li><a href="#c-5" id="toc-c-5" class="nav-link" data-scroll-target="#c-5">C</a></li>
  <li><a href="#d-5" id="toc-d-5" class="nav-link" data-scroll-target="#d-5">D</a></li>
  <li><a href="#e-3" id="toc-e-3" class="nav-link" data-scroll-target="#e-3">E</a></li>
  <li><a href="#f-2" id="toc-f-2" class="nav-link" data-scroll-target="#f-2">F</a></li>
  <li><a href="#g-1" id="toc-g-1" class="nav-link" data-scroll-target="#g-1">G</a></li>
  <li><a href="#h-1" id="toc-h-1" class="nav-link" data-scroll-target="#h-1">H</a></li>
  </ul>
</li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title d-none d-lg-block">05 - Resampling Methods</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><style>

h3, h4 {
    position: absolute;
    width: 1px;
    height: 1px;
    padding: 0;
    margin: -1px;
    overflow: hidden;
    clip: rect(0,0,0,0);
    border: 0;
}

</style>
<section id="libraries" class="level2"><h2 class="anchored" data-anchor-id="libraries">Libraries</h2>
<div class="cell">
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://scales.r-lib.org">scales</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://tidymodels.tidymodels.org">tidymodels</a></span><span class="op">)</span></span>
<span><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span><span class="op">(</span><span class="va"><a href="https://r-datatable.com">data.table</a></span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="conceptual" class="level2"><h2 class="anchored" data-anchor-id="conceptual">Conceptual</h2>
<section id="section" class="level3"><h3 class="anchored" data-anchor-id="section">1</h3>
<p><strong>1.</strong> Using basic statistical properties of the variance, as well as single-variable calculus, derive (5.6). In other words, prove that <span class="math inline">\(\alpha\)</span> given by (5.6) does indeed minimize <span class="math inline">\(\text{Var}(\alpha X + (1-\alpha)Y)\)</span>.</p>
<p>By taking as a reference the Propagation section of the <a href="https://en.wikipedia.org/wiki/Variance#Propagation">Variance</a> Wikipedia post.</p>
<p><span class="math display">\[
\begin{split}
\text{Var}(\alpha X + (1-\alpha)Y) &amp; =  
        \alpha^2 \text{Var}(X)+
        (1-\alpha)^2  \text{Var}(Y) +
        2 \alpha (1-\alpha)   \text{Cov}(X,Y) \\
    &amp; = \alpha^2      \text{Var}(X)+
        (1 - 2 \alpha + \alpha^2) \text{Var}(Y) +
         (2 \alpha-2\alpha^2)   \text{Cov}(X,Y) \\
    &amp; = \alpha^2      \text{Var}(X)+
        \text{Var}(Y) - 2 \alpha \text{Var}(Y) + \alpha^2 \text{Var}(Y)+
         2 \alpha \text{Cov}(X,Y) - 2\alpha^2 \text{Cov}(X,Y)    \\   
    &amp; = [\text{Var}(X) + \text{Var}(Y) - 2 \text{Cov}(X,Y)] \alpha^2 +
        2[ \text{Cov}(X,Y) - \text{Var}(Y)] \alpha + \text{Var}(Y)
\end{split}
\]</span></p>
<p>Once we have the function, we can derivative using the <a href="https://en.wikipedia.org/wiki/Derivative#Rules_for_basic_functions">derivative of power</a> and solve the equation.</p>
<p><span class="math display">\[
\begin{split}
2[\text{Var}(X) + \text{Var}(Y) - 2 \text{Cov}(X,Y)] \alpha + 2[ \text{Cov}(X,Y) - \text{Var}(Y)] &amp; =  0 \\
2[\text{Var}(X) + \text{Var}(Y) - 2 \text{Cov}(X,Y)] \alpha &amp; = 2[\text{Var}(Y) - \text{Cov}(X,Y)] \\
\alpha  = \frac{\text{Var}(Y) - \text{Cov}(X,Y)}{\text{Var}(X) + \text{Var}(Y) - 2 \text{Cov}(X,Y)}
\end{split}
\]</span></p>
</section><section id="section-1" class="level3"><h3 class="anchored" data-anchor-id="section-1">2</h3>
<p><strong>2.</strong> We will now derive the probability that a given observation is part of a bootstrap sample. Suppose that we obtain a bootstrap sample from a set of n observations.</p>
<section id="a" class="level4"><h4 class="anchored" data-anchor-id="a">A</h4>
<p><strong>(A)</strong> What is the probability that the ﬁrst bootstrap observation is not the <em>j</em>th observation from the original sample? Justify your answer.</p>
<p>The probability of an observation to be in any position of the bootstrap sample is <span class="math inline">\(1/n\)</span> and the opposite <span class="math inline">\(1 - 1/n\)</span>.</p>
</section><section id="b" class="level4"><h4 class="anchored" data-anchor-id="b">B</h4>
<p><strong>(B)</strong> What is the probability that the second bootstrap observation is not the <em>j</em>th observation from the original sample?</p>
<p>The probability it’s the same (<span class="math inline">\(1 - 1/n\)</span>) as we are sampling with replacement.</p>
</section><section id="c" class="level4"><h4 class="anchored" data-anchor-id="c">C</h4>
<p><strong>(C)</strong> Argue that the probability that the <em>j</em>th observation is <em>not</em> in the bootstrap sample is <span class="math inline">\((1 - 1/n)^n\)</span>.</p>
<p>As the probability of the <em>j</em>th observation for avoiding each position in bootstrap sample is <span class="math inline">\(1 - 1/n\)</span> to get the probability in that situation we should use <span class="math inline">\((1 - 1/n)^n\)</span> as the probabilities are independent.</p>
</section><section id="d" class="level4"><h4 class="anchored" data-anchor-id="d">D</h4>
<p><strong>(D)</strong> When <span class="math inline">\(n = 5\)</span>, what is the probability that the <em>j</em>th observation is in the bootstrap sample?</p>
<p>As <span class="math inline">\((1 - 1/5)^5\)</span> represent the probability that an observation won’t appear.</p>
<p><span class="math display">\[
1 - (1 - 1/5)^5 = 0.6723
\]</span></p>
</section><section id="e" class="level4"><h4 class="anchored" data-anchor-id="e">E</h4>
<p><strong>(E)</strong> When <span class="math inline">\(n = 100\)</span>, what is the probability that the <em>j</em>th observation is in the bootstrap sample?</p>
<p><span class="math display">\[
1 - (1 - 1/100)^{100} = 0.6340
\]</span></p>
</section><section id="f" class="level4"><h4 class="anchored" data-anchor-id="f">F</h4>
<p><strong>(F)</strong> When <span class="math inline">\(n = 10,000\)</span>, what is the probability that the <em>j</em>th observation is in the bootstrap sample?</p>
<p><span class="math display">\[
1 - (1 - 1/10000)^{10000} = 0.6321
\]</span></p>
</section><section id="g" class="level4"><h4 class="anchored" data-anchor-id="g">G</h4>
<p><strong>(G)</strong> Create a plot that displays, for each integer value of n from <span class="math inline">\(1\)</span> to <span class="math inline">\(100,000\)</span>, the probability that the <em>j</em>th observation is in the bootstrap sample. Comment on what you observe.</p>
<div class="cell">
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>x <span class="op">=</span> <span class="fl">1</span><span class="op">:</span><span class="fl">1e4</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_function</span><span class="op">(</span><span class="fu">aes</span><span class="op">(</span><span class="va">x</span><span class="op">)</span>, fun <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fl">1</span> <span class="op">-</span> <span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fl">1</span><span class="op">/</span><span class="va">x</span><span class="op">)</span><span class="op">^</span><span class="va">x</span>, </span>
<span>                color <span class="op">=</span> <span class="st">"blue"</span>, linewidth <span class="op">=</span> <span class="fl">0.8</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_hline</span><span class="op">(</span>yintercept <span class="op">=</span> <span class="fl">1</span> <span class="op">-</span> <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, linetype <span class="op">=</span> <span class="fl">2</span>,</span>
<span>             color <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/character.html">as.character</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/Round.html">round</a></span><span class="op">(</span><span class="fl">1</span> <span class="op">-</span> <span class="fl">1</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/Log.html">exp</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span>, <span class="fl">4</span><span class="op">)</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">expand_limits</span><span class="op">(</span>y <span class="op">=</span> <span class="fl">0</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">labs</span><span class="op">(</span>x <span class="op">=</span> <span class="st">"Number of observations"</span>,</span>
<span>       y <span class="op">=</span> <span class="st">"Probability"</span>,</span>
<span>       title <span class="op">=</span> <span class="st">"Probability an observation is in the bootstrap sample"</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">scale_y_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/percent_format.html">percent_format</a></span><span class="op">(</span>accuracy <span class="op">=</span> <span class="fl">1</span><span class="op">)</span>,</span>
<span>                     breaks <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/breaks_width.html">breaks_width</a></span><span class="op">(</span><span class="fl">0.1</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">scale_x_continuous</span><span class="op">(</span>labels <span class="op">=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/comma.html">comma_format</a></span><span class="op">(</span>accuracy <span class="op">=</span> <span class="fl">1</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_light</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>panel.grid.minor <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>        panel.grid.major.x <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span>,</span>
<span>        plot.title <span class="op">=</span> <span class="fu">element_text</span><span class="op">(</span>hjust <span class="op">=</span> <span class="fl">0.5</span>, face <span class="op">=</span> <span class="st">"bold"</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05-execises_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="h" class="level4"><h4 class="anchored" data-anchor-id="h">H</h4>
<p><strong>(H)</strong> We will now investigate numerically the probability that a bootstrap sample of size <span class="math inline">\(n = 100\)</span> contains the <em>j</em>th observation. Here <span class="math inline">\(j = 4\)</span>. We repeatedly create bootstrap samples, and each time we record whether or not the fourth observation is contained in the bootstrap sample.</p>
<div class="cell">
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">2018</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/lapply.html">vapply</a></span><span class="op">(</span><span class="fl">1</span><span class="op">:</span><span class="fl">1e4</span>, </span>
<span>       FUN <span class="op">=</span> \<span class="op">(</span><span class="va">x</span><span class="op">)</span> <span class="fl">4L</span> <span class="op"><a href="https://rdrr.io/r/base/match.html">%in%</a></span> <span class="fu"><a href="https://rdrr.io/r/base/sample.html">sample.int</a></span><span class="op">(</span><span class="fl">100L</span>, <span class="fl">100L</span>, replace <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span>,</span>
<span>       FUN.VALUE <span class="op">=</span> <span class="cn">TRUE</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.6329</code></pre>
</div>
</div>
<p>As we can see the probability es really close to <span class="math inline">\(0.6340\)</span>.</p>
</section></section><section id="section-2" class="level3"><h3 class="anchored" data-anchor-id="section-2">3</h3>
<p><strong>3.</strong> We now review k-fold cross-validation.</p>
<section id="a-1" class="level4"><h4 class="anchored" data-anchor-id="a-1">A</h4>
<p><strong>(A)</strong> Explain how k-fold cross-validation is implemented.</p>
<p>It involves randomly dividing the set of observations into <em>k</em> groups, or folds, of approximately equal size. The ﬁrst fold is treated as a validation set, and the method is ﬁt on the remaining <span class="math inline">\(k - 1\)</span> folds.</p>
</section><section id="b-1" class="level4"><h4 class="anchored" data-anchor-id="b-1">B</h4>
<p><strong>(B)</strong> What are the advantages and disadvantages of <em>k</em>-fold cross validation relative to the validation set approach and the LOOCV?</p>
<table class="table">
<thead><tr class="header">
<th style="text-align: left;">Main Characteristics</th>
<th style="text-align: center;">Validation Set Approach</th>
<th style="text-align: center;">LOOCV</th>
</tr></thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Accuracy in estimating the testing error</td>
<td style="text-align: center;">Lower</td>
<td style="text-align: center;"><a href="https://stats.stackexchange.com/questions/61783/bias-and-variance-in-leave-one-out-vs-k-fold-cross-validation">Lower</a></td>
</tr>
<tr class="even">
<td style="text-align: left;">Time efficiency</td>
<td style="text-align: center;">Higher</td>
<td style="text-align: center;">Lower</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Proportion of data used to train the models (bias mitigation)</td>
<td style="text-align: center;">Lower</td>
<td style="text-align: center;">Higher</td>
</tr>
<tr class="even">
<td style="text-align: left;">Estimation variance</td>
<td style="text-align: center;">-</td>
<td style="text-align: center;">Higher</td>
</tr>
</tbody>
</table></section></section><section id="section-3" class="level3"><h3 class="anchored" data-anchor-id="section-3">4</h3>
<p><strong>4.</strong> Suppose that we use some statistical learning method to make a prediction for the response <em>Y</em> for a particular value of the predictor <em>X</em>. Carefully describe how we might estimate the standard deviation of our prediction.</p>
<p>I would use to bootstrap method to re-sample the original data set many times, fit a statistical learning method on each re-sample, predict the value based on the predictors we want to study and calculate the standard deviation of the response, which is a good approximation of the standard error as we can on page 210.</p>
</section></section><section id="applied" class="level2"><h2 class="anchored" data-anchor-id="applied">Applied</h2>
<section id="section-4" class="level3"><h3 class="anchored" data-anchor-id="section-4">5</h3>
<p><strong>5.</strong> In Chapter 4, we used logistic regression to predict the probability of <code>default</code> using <code>income</code> and <code>balance</code> on the <code>Default</code> data set. We will now estimate the test error of this logistic regression model using the validation set approach. Do not forget to set a random seed before beginning your analysis.</p>
<div class="cell">
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">DefaultFormulaToFit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html">as.formula</a></span><span class="op">(</span><span class="st">"default ~ balance + income"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<section id="a-2" class="level4"><h4 class="anchored" data-anchor-id="a-2">A</h4>
<p><strong>(A)</strong> Fit a logistic regression model that uses <code>income</code> and <code>balance</code> to predict <code>default</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">DefaultFittedModel</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">logistic_reg</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">fit</span><span class="op">(</span><span class="va">DefaultFormulaToFit</span>, data <span class="op">=</span> <span class="fu">ISLR</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ISLR/man/Default.html">Default</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">DefaultFittedModel</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>parsnip model object


Call:  stats::glm(formula = default ~ balance + income, family = stats::binomial, 
    data = data)

Coefficients:
(Intercept)      balance       income  
 -1.154e+01    5.647e-03    2.081e-05  

Degrees of Freedom: 9999 Total (i.e. Null);  9997 Residual
Null Deviance:      2921 
Residual Deviance: 1579     AIC: 1585</code></pre>
</div>
</div>
</section><section id="b-2" class="level4"><h4 class="anchored" data-anchor-id="b-2">B</h4>
<p><strong>(B)</strong> Using the validation set approach, estimate the test error of this model. In order to do this, you must perform the following steps:</p>
<ol type="1">
<li>Split the sample set into a training set and a validation set.</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">4</span><span class="op">)</span></span>
<span></span>
<span><span class="va">DefaultSplit</span> <span class="op">&lt;-</span> <span class="fu">initial_split</span><span class="op">(</span><span class="fu">ISLR</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ISLR/man/Default.html">Default</a></span>, prop <span class="op">=</span> <span class="fl">0.5</span>, strata <span class="op">=</span> <span class="va">default</span><span class="op">)</span></span>
<span></span>
<span><span class="va">DefaultSplit</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>&lt;Training/Testing/Total&gt;
&lt;5000/5000/10000&gt;</code></pre>
</div>
</div>
<ol start="2" type="1">
<li>Fit a multiple logistic regression model using only the training observations.</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">DefaultTrainingModel</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">logistic_reg</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">fit</span><span class="op">(</span><span class="va">DefaultFormulaToFit</span>, data <span class="op">=</span> <span class="fu">training</span><span class="op">(</span><span class="va">DefaultSplit</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">DefaultTrainingModel</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>parsnip model object


Call:  stats::glm(formula = default ~ balance + income, family = stats::binomial, 
    data = data)

Coefficients:
(Intercept)      balance       income  
 -1.153e+01    5.598e-03    2.384e-05  

Degrees of Freedom: 4999 Total (i.e. Null);  4997 Residual
Null Deviance:      1484 
Residual Deviance: 813.8    AIC: 819.8</code></pre>
</div>
</div>
<ol start="3" type="1">
<li>Obtain a prediction of default status for each individual in the validation set by computing the posterior probability of default for that individual, and classifying the individual to the <code>default</code> category if the posterior probability is greater than 0.5.</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">DefaultTestPredictions</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">augment</span><span class="op">(</span><span class="va">DefaultTrainingModel</span>, new_data <span class="op">=</span> <span class="fu">testing</span><span class="op">(</span><span class="va">DefaultSplit</span><span class="op">)</span><span class="op">)</span></span>
<span></span>
<span><span class="va">DefaultTestPredictions</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 5,000 × 7
   default student balance income .pred_class .pred_No .pred_Yes
   &lt;fct&gt;   &lt;fct&gt;     &lt;dbl&gt;  &lt;dbl&gt; &lt;fct&gt;          &lt;dbl&gt;     &lt;dbl&gt;
 1 No      No         529. 35704. No             1.00  0.000446 
 2 No      Yes        920.  7492. No             0.998 0.00202  
 3 No      Yes        809. 17600. No             0.999 0.00138  
 4 No      No           0  29275. No             1.00  0.0000198
 5 No      No         237. 28252. No             1.00  0.0000728
 6 No      No         607. 44995. No             0.999 0.000859 
 7 No      No           0  50265. No             1.00  0.0000326
 8 No      No         486. 61566. No             0.999 0.000649 
 9 No      No        1095. 26465. No             0.992 0.00844  
10 No      No         954. 32458. No             0.996 0.00444  
# ℹ 4,990 more rows</code></pre>
</div>
</div>
<ol start="4" type="1">
<li>Compute the validation set error, which is the fraction of the observations in the validation set that are misclassiﬁed.</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb14"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">DefaultTestPredictions</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span>`Test error rate` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">default</span> <span class="op">!=</span> <span class="va">.pred_class</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  `Test error rate`
              &lt;dbl&gt;
1            0.0242</code></pre>
</div>
</div>
</section><section id="c-1" class="level4"><h4 class="anchored" data-anchor-id="c-1">C</h4>
<p><strong>(C)</strong> Repeat the process in (b) three times, using three diﬀerent splits of the observations into a training set and a validation set. Comment on the results obtained.</p>
<div class="cell">
<div class="sourceCode" id="cb16"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">DefaultBasedResults</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fl">8</span><span class="op">:</span><span class="fl">10</span>, </span>
<span>         model_recipe <span class="op">=</span> <span class="fu">recipe</span><span class="op">(</span><span class="va">DefaultFormulaToFit</span>, data <span class="op">=</span> <span class="fu">ISLR</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ISLR/man/Default.html">Default</a></span><span class="op">)</span>,</span>
<span>         </span>
<span>         FUN <span class="op">=</span> \<span class="op">(</span><span class="va">seed</span>, <span class="va">model_recipe</span><span class="op">)</span><span class="op">{</span></span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="va">seed</span><span class="op">)</span></span>
<span>           </span>
<span>           <span class="va">split</span> <span class="op">&lt;-</span> <span class="fu">initial_split</span><span class="op">(</span><span class="fu">ISLR</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ISLR/man/Default.html">Default</a></span>, prop <span class="op">=</span> <span class="fl">0.5</span>, strata <span class="op">=</span> <span class="va">default</span><span class="op">)</span></span>
<span>           </span>
<span>           <span class="fu">workflow</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>             <span class="fu">add_model</span><span class="op">(</span><span class="fu">logistic_reg</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>             <span class="fu">add_recipe</span><span class="op">(</span><span class="va">model_recipe</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>             <span class="fu">last_fit</span><span class="op">(</span>split <span class="op">=</span> <span class="va">split</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>             <span class="fu">collect_predictions</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>             <span class="fu">summarize</span><span class="op">(</span>seed_used <span class="op">=</span> <span class="va">seed</span>,</span>
<span>                       `test_error_rate` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">.pred_class</span> <span class="op">!=</span> <span class="va">default</span><span class="op">)</span><span class="op">)</span> <span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html">rbindlist</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span><span class="va">DefaultBasedResults</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   seed_used test_error_rate
       &lt;int&gt;           &lt;num&gt;
1:         8          0.0262
2:         9          0.0240
3:        10          0.0282</code></pre>
</div>
</div>
</section><section id="d-1" class="level4"><h4 class="anchored" data-anchor-id="d-1">D</h4>
<p><strong>(D)</strong> Now consider a logistic regression model that predicts the probability of <code>default</code> using <code>income</code>, <code>balance</code>, and a dummy variable for <code>student</code>. Estimate the test error for this model using the validation set approach. Comment on whether or not including a dummy variable for student leads to a reduction in the test error rate.</p>
<p>Adding the student variable as a dummy one doesn’t make a big impact on the prediction accurency.</p>
<div class="cell">
<div class="sourceCode" id="cb18"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">DefaultDummyRecipe</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu">recipe</span><span class="op">(</span><span class="va">default</span> <span class="op">~</span> <span class="va">.</span>, data <span class="op">=</span> <span class="fu">ISLR</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ISLR/man/Default.html">Default</a></span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">step_dummy</span><span class="op">(</span><span class="va">student</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">DefaultDummyResults</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="fl">8</span><span class="op">:</span><span class="fl">10</span>, </span>
<span>         model_recipe <span class="op">=</span> <span class="va">DefaultDummyRecipe</span>,</span>
<span>         </span>
<span>         FUN <span class="op">=</span> \<span class="op">(</span><span class="va">seed</span>, <span class="va">model_recipe</span><span class="op">)</span><span class="op">{</span></span>
<span>           <span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="va">seed</span><span class="op">)</span></span>
<span>           </span>
<span>           <span class="va">split</span> <span class="op">&lt;-</span> <span class="fu">initial_split</span><span class="op">(</span><span class="fu">ISLR</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ISLR/man/Default.html">Default</a></span>, prop <span class="op">=</span> <span class="fl">0.5</span>, strata <span class="op">=</span> <span class="va">default</span><span class="op">)</span></span>
<span>           </span>
<span>           <span class="fu">workflow</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>             <span class="fu">add_model</span><span class="op">(</span><span class="fu">logistic_reg</span><span class="op">(</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>             <span class="fu">add_recipe</span><span class="op">(</span><span class="va">model_recipe</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>             <span class="fu">last_fit</span><span class="op">(</span>split <span class="op">=</span> <span class="va">split</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>             <span class="fu">collect_predictions</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>             <span class="fu">summarize</span><span class="op">(</span>seed_used <span class="op">=</span> <span class="va">seed</span>,</span>
<span>                       `test_error_rate_dummy` <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">.pred_class</span> <span class="op">!=</span> <span class="va">default</span><span class="op">)</span><span class="op">)</span> <span class="op">}</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html">rbindlist</a></span><span class="op">(</span><span class="op">)</span></span>
<span></span>
<span></span>
<span><span class="va">DefaultBasedResults</span><span class="op">[</span><span class="va">DefaultDummyResults</span>, on <span class="op">=</span> <span class="st">"seed_used"</span></span>
<span><span class="op">]</span><span class="op">[</span>, <span class="va">diff</span> <span class="op">:=</span> <span class="fu"><a href="https://scales.r-lib.org/reference/comma.html">comma</a></span><span class="op">(</span><span class="va">test_error_rate_dummy</span> <span class="op">-</span> <span class="va">test_error_rate</span>, accuracy <span class="op">=</span> <span class="fl">0.0001</span><span class="op">)</span><span class="op">]</span><span class="op">[</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   seed_used test_error_rate test_error_rate_dummy    diff
       &lt;int&gt;           &lt;num&gt;                 &lt;num&gt;  &lt;char&gt;
1:         8          0.0262                0.0260 -0.0002
2:         9          0.0240                0.0248  0.0008
3:        10          0.0282                0.0278 -0.0004</code></pre>
</div>
</div>
</section></section><section id="section-5" class="level3"><h3 class="anchored" data-anchor-id="section-5">6</h3>
<p><strong>6.</strong> We continue to consider the use of a logistic regression model to predict the probability of <code>default</code> using <code>income</code> and <code>balance</code> on the <code>Default</code> data set. In particular, we will now compute estimates for the standard errors of the <code>income</code> and <code>balance</code> logistic regression coeﬃcients in two diﬀerent ways: (1) using the bootstrap, and (2) using the standard formula for computing the standard errors in the <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> function. Do not forget to set a random seed before beginning your analysis.</p>
<section id="a-3" class="level4"><h4 class="anchored" data-anchor-id="a-3">A</h4>
<p><strong>(A)</strong> Using the <code><a href="https://rdrr.io/r/base/summary.html">summary()</a></code> and <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> functions, determine the estimated standard errors for the coeﬃcients associated with <code>income</code> and <code>balance</code> in a multiple logistic regression model that uses both predictors.</p>
<div class="cell">
<div class="sourceCode" id="cb20"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">DefaultGlmSummary</span> <span class="op">&lt;-</span> <span class="fu">tidy</span><span class="op">(</span><span class="va">DefaultFittedModel</span><span class="op">)</span></span>
<span></span>
<span><span class="va">DefaultGlmSummary</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 3 × 5
  term           estimate  std.error statistic   p.value
  &lt;chr&gt;             &lt;dbl&gt;      &lt;dbl&gt;     &lt;dbl&gt;     &lt;dbl&gt;
1 (Intercept) -11.5       0.435         -26.5  2.96e-155
2 balance       0.00565   0.000227       24.8  3.64e-136
3 income        0.0000208 0.00000499      4.17 2.99e-  5</code></pre>
</div>
</div>
</section><section id="b-3" class="level4"><h4 class="anchored" data-anchor-id="b-3">B</h4>
<p><strong>(B)</strong> Write a function, <code>boot.fn()</code>, that takes as input the <code>Default</code> data set as well as an index of the observations, and that outputs the coeﬃcient estimates for <code>income</code> and <code>balance</code> in the multiple logistic regression model.</p>
<p>To create the function it’s optimal</p>
</section><section id="c-2" class="level4"><h4 class="anchored" data-anchor-id="c-2">C</h4>
<p><strong>(C)</strong> Use the <code>boot()</code> function together with your <code>boot.fn()</code> function to estimate the standard errors of the logistic regression coeﬃcients for <code>income</code> and <code>balance</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb22"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">15</span><span class="op">)</span></span>
<span></span>
<span><span class="va">DefaultBootstrapsSe</span> <span class="op">&lt;-</span> </span>
<span>  <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/as.data.table.html">as.data.table</a></span><span class="op">(</span><span class="fu">bootstraps</span><span class="op">(</span><span class="fu">ISLR</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ISLR/man/Default.html">Default</a></span>, times <span class="op">=</span> <span class="fl">500</span><span class="op">)</span></span>
<span>  <span class="op">)</span><span class="op">[</span>, <span class="fu">logistic_reg</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span> </span>
<span>      <span class="fu">fit</span><span class="op">(</span><span class="va">DefaultFormulaToFit</span>, </span>
<span>          data <span class="op">=</span> <span class="fu">analysis</span><span class="op">(</span><span class="va">splits</span><span class="op">[[</span><span class="fl">1L</span><span class="op">]</span><span class="op">]</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>      <span class="fu">tidy</span><span class="op">(</span><span class="op">)</span>,</span>
<span>    by <span class="op">=</span> <span class="st">"id"</span></span>
<span>  <span class="op">]</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span>SE <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">estimate</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    by <span class="op">=</span> <span class="st">"term"</span><span class="op">]</span></span>
<span></span>
<span></span>
<span><span class="va">DefaultBootstrapsSe</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          term           SE
        &lt;char&gt;        &lt;num&gt;
1: (Intercept) 4.230130e-01
2:     balance 2.203893e-04
3:      income 4.895823e-06</code></pre>
</div>
</div>
</section><section id="d-2" class="level4"><h4 class="anchored" data-anchor-id="d-2">D</h4>
<p><strong>(D)</strong> Comment on the estimated standard errors obtained using the <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> function and using your bootstrap function.</p>
<p>As you can see bellow the results are really close to each other.</p>
<div class="cell">
<div class="sourceCode" id="cb24"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">left_join</span><span class="op">(</span><span class="va">DefaultBootstrapsSe</span>,</span>
<span>          <span class="va">DefaultGlmSummary</span><span class="op">[</span>,<span class="fu"><a href="https://rdrr.io/r/base/c.html">c</a></span><span class="op">(</span><span class="st">"term"</span>,<span class="st">"std.error"</span><span class="op">)</span><span class="op">]</span>,</span>
<span>          by <span class="op">=</span> <span class="st">"term"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>diff <span class="op">=</span> <span class="va">SE</span> <span class="op">-</span> <span class="va">std.error</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>          term           SE    std.error          diff
        &lt;char&gt;        &lt;num&gt;        &lt;num&gt;         &lt;num&gt;
1: (Intercept) 4.230130e-01 4.347564e-01 -1.174338e-02
2:     balance 2.203893e-04 2.273731e-04 -6.983879e-06
3:      income 4.895823e-06 4.985167e-06 -8.934457e-08</code></pre>
</div>
</div>
</section></section><section id="section-6" class="level3"><h3 class="anchored" data-anchor-id="section-6">7</h3>
<p><strong>7.</strong> In Sections 5.3.2 and 5.3.3, we saw that the <code>cv.glm()</code> function can be used in order to compute the LOOCV test error estimate. Alternatively, one could compute those quantities using just the <code><a href="https://rdrr.io/r/stats/glm.html">glm()</a></code> and <code><a href="https://rdrr.io/r/stats/predict.glm.html">predict.glm()</a></code> functions, and a for loop. You will now take this approach in order to compute the LOOCV error for a simple logistic regression model on the Weekly data set. Recall that in the context of classiﬁcation problems, the LOOCV error is given in (5.4).</p>
<section id="a-4" class="level4"><h4 class="anchored" data-anchor-id="a-4">A</h4>
<p><strong>(A)</strong> Fit a logistic regression model that predicts <code>Direction</code> using <code>Lag1</code> and <code>Lag2</code>.</p>
<div class="cell">
<div class="sourceCode" id="cb26"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">WeeklyModel</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">logistic_reg</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">fit</span><span class="op">(</span><span class="va">Direction</span> <span class="op">~</span> <span class="va">Lag1</span> <span class="op">+</span> <span class="va">Lag2</span>, data <span class="op">=</span> <span class="fu">ISLR</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ISLR/man/Weekly.html">Weekly</a></span><span class="op">)</span></span>
<span></span>
<span><span class="va">WeeklyModel</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>parsnip model object


Call:  stats::glm(formula = Direction ~ Lag1 + Lag2, family = stats::binomial, 
    data = data)

Coefficients:
(Intercept)         Lag1         Lag2  
    0.22122     -0.03872      0.06025  

Degrees of Freedom: 1088 Total (i.e. Null);  1086 Residual
Null Deviance:      1496 
Residual Deviance: 1488     AIC: 1494</code></pre>
</div>
</div>
</section><section id="b-4" class="level4"><h4 class="anchored" data-anchor-id="b-4">B</h4>
<p><strong>(B)</strong> Fit a logistic regression model that predicts <code>Direction</code> using <code>Lag1</code> and <code>Lag2</code> <em>using all but the ﬁrst observation</em>.</p>
<div class="cell">
<div class="sourceCode" id="cb28"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">WeeklyModelNotFirst</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">logistic_reg</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">fit</span><span class="op">(</span><span class="va">Direction</span> <span class="op">~</span> <span class="va">Lag1</span> <span class="op">+</span> <span class="va">Lag2</span>, data <span class="op">=</span> <span class="fu">ISLR</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ISLR/man/Weekly.html">Weekly</a></span><span class="op">[</span><span class="op">-</span><span class="fl">1L</span>,<span class="op">]</span><span class="op">)</span></span>
<span></span>
<span><span class="va">WeeklyModelNotFirst</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>parsnip model object


Call:  stats::glm(formula = Direction ~ Lag1 + Lag2, family = stats::binomial, 
    data = data)

Coefficients:
(Intercept)         Lag1         Lag2  
    0.22324     -0.03843      0.06085  

Degrees of Freedom: 1087 Total (i.e. Null);  1085 Residual
Null Deviance:      1495 
Residual Deviance: 1487     AIC: 1493</code></pre>
</div>
</div>
</section><section id="c-3" class="level4"><h4 class="anchored" data-anchor-id="c-3">C</h4>
<p><strong>(C)</strong> Use the model from (b) to predict the direction of the ﬁrst observation. You can do this by predicting that the ﬁrst observation will go up if <em>P</em>(<code>Direction = "Up"</code> | <code>Lag1</code>, <code>Lag2</code>) &gt; 0.5. Was this observation correctly classiﬁed?</p>
<p>No, it wasn’t.</p>
<div class="cell">
<div class="sourceCode" id="cb30"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">WeeklyModelNotFirst</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">augment</span><span class="op">(</span>new_data <span class="op">=</span> <span class="fu">ISLR</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ISLR/man/Weekly.html">Weekly</a></span><span class="op">[</span><span class="fl">1L</span>,<span class="op">]</span> <span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 12
   Year  Lag1  Lag2  Lag3   Lag4  Lag5 Volume Today Direction .pred_class
  &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt;  &lt;dbl&gt; &lt;dbl&gt; &lt;fct&gt;     &lt;fct&gt;      
1  1990 0.816  1.57 -3.94 -0.229 -3.48  0.155 -0.27 Down      Up         
# ℹ 2 more variables: .pred_Down &lt;dbl&gt;, .pred_Up &lt;dbl&gt;</code></pre>
</div>
</div>
</section><section id="d-3" class="level4"><h4 class="anchored" data-anchor-id="d-3">D</h4>
<p><strong>(D)</strong> Write a for loop from <span class="math inline">\(i = 1\)</span> to <span class="math inline">\(i = n\)</span>, where n is the number of observations in the data set, that performs each of the following steps:</p>
<ol type="1">
<li>Fit a logistic regression model using all but the <em>i</em>th observation to predict <code>Direction</code> using <code>Lag1</code> and <code>Lag2</code>.</li>
<li>Compute the posterior probability of the market moving up for the <em>i</em>th observation.</li>
<li>Use the posterior probability for the <em>i</em>th observation in order to predict whether or not the market moves up.</li>
<li>Determine whether or not an error was made in predicting the direction for the <em>i</em>th observation. If an error was made, then indicate this as a 1, and otherwise indicate it as a 0.</li>
</ol>
<div class="cell">
<div class="sourceCode" id="cb32"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">WeeklyLoocv</span> <span class="op">&lt;-</span> <span class="fu">loo_cv</span><span class="op">(</span><span class="fu">ISLR</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ISLR/man/Weekly.html">Weekly</a></span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setDT.html">setDT</a></span><span class="op">(</span><span class="va">WeeklyLoocv</span><span class="op">)</span></span>
<span></span>
<span><span class="va">WeeklyLoocvPredictions</span> <span class="op">&lt;-</span></span>
<span>  <span class="va">WeeklyLoocv</span><span class="op">[</span>, <span class="fu">training</span><span class="op">(</span><span class="va">splits</span><span class="op">[[</span><span class="fl">1L</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"id"</span></span>
<span>  <span class="op">]</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span>model <span class="op">=</span> <span class="fu">.</span><span class="op">(</span><span class="fu">logistic_reg</span><span class="op">(</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>                    <span class="fu">fit</span><span class="op">(</span><span class="va">Direction</span> <span class="op">~</span> <span class="va">Lag1</span> <span class="op">+</span> <span class="va">Lag2</span>, data <span class="op">=</span> <span class="va">.SD</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>    by <span class="op">=</span> <span class="st">"id"</span></span>
<span>  <span class="op">]</span><span class="op">[</span><span class="va">WeeklyLoocv</span><span class="op">[</span>, <span class="fu">testing</span><span class="op">(</span><span class="va">splits</span><span class="op">[[</span><span class="fl">1L</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">]</span>,</span>
<span>    on <span class="op">=</span> <span class="st">"id"</span></span>
<span>  <span class="op">]</span><span class="op">[</span>, <span class="va">.pred_class</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">model</span><span class="op">[[</span><span class="fl">1L</span><span class="op">]</span><span class="op">]</span>, new_data <span class="op">=</span> <span class="va">.SD</span>, type <span class="op">=</span> <span class="st">"class"</span><span class="op">)</span>,</span>
<span>    by <span class="op">=</span> <span class="st">"id"</span></span>
<span>  <span class="op">]</span><span class="op">[</span>, <span class="va">is_error</span> <span class="op">:=</span> <span class="va">Direction</span> <span class="op">!=</span> <span class="va">.pred_class</span><span class="op">]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="e-1" class="level4"><h4 class="anchored" data-anchor-id="e-1">E</h4>
<p><strong>(E)</strong> Take the average of the <em>n</em> numbers obtained in (4d) in order to obtain the LOOCV estimate for the test error. Comment on the results.</p>
<div class="cell">
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="va">WeeklyLoocvPredictions</span><span class="op">$</span><span class="va">is_error</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 0.4499541</code></pre>
</div>
</div>
</section></section><section id="section-7" class="level3"><h3 class="anchored" data-anchor-id="section-7">8</h3>
<section id="a-5" class="level4"><h4 class="anchored" data-anchor-id="a-5">A</h4>
<p><strong>(A)</strong> Generate a simulated data set as follows. In this data set, what is <em>n</em> and what is <em>p</em>? Write out the model used to generate the data in equation form.</p>
<div class="cell">
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span></span>
<span><span class="va">x</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">&lt;-</span> <span class="va">x</span><span class="op">-</span> <span class="fl">2</span><span class="op">*</span><span class="va">x</span><span class="op">^</span><span class="fl">2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">100</span><span class="op">)</span></span>
<span></span>
<span><span class="va">SimulatedDt</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/data.table.html">data.table</a></span><span class="op">(</span><span class="va">x</span>, <span class="va">y</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
<p>n: 100 and p: 1.</p>
</section><section id="b-5" class="level4"><h4 class="anchored" data-anchor-id="b-5">B</h4>
<p><strong>(B)</strong> Create a scatterplot of X against Y. Comment on what you ﬁnd.</p>
<p>The values follows a function of second degree.</p>
<div class="cell">
<div class="sourceCode" id="cb36"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="va">SimulatedDt</span>, <span class="fu">aes</span><span class="op">(</span><span class="va">x</span>,  <span class="va">y</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_point</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_smooth</span><span class="op">(</span>se <span class="op">=</span> <span class="cn">FALSE</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_light</span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05-execises_files/figure-html/unnamed-chunk-21-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="c-4" class="level4"><h4 class="anchored" data-anchor-id="c-4">C</h4>
<p><strong>(C)</strong> Set a random seed, and then compute the LOOCV errors that result from ﬁtting the following four models using least squares. Note you may ﬁnd it helpful to use the <code><a href="https://rdrr.io/r/base/data.frame.html">data.frame()</a></code> function to create a single data set containing both X and Y .</p>
<ol type="1">
<li><span class="math inline">\(Y = \beta_0 + \beta_1 X + \epsilon\)</span></li>
<li><span class="math inline">\(Y = \beta_0 + \beta_1 X + \beta_2 X^2 + \epsilon\)</span></li>
<li><span class="math inline">\(Y = \beta_0 + \beta_1 X + \beta_2 X^2 + \beta_3 X^3 + \epsilon\)</span></li>
<li><span class="math inline">\(Y = \beta_0 + \beta_1 X + \beta_2 X^2 + \beta_3 X^3 + \beta_4 X^4 + \epsilon\)</span></li>
</ol>
<p>we don’t need to set a seed when performing LOOCV, as we don’t do anything at random.</p>
<div class="cell">
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">collect_loo_testing_error</span> <span class="op">&lt;-</span> <span class="kw">function</span><span class="op">(</span><span class="va">formula</span>,</span>
<span>                                      <span class="va">loo_split</span>,</span>
<span>                                      <span class="va">metric_function</span> <span class="op">=</span> <span class="va">rmse</span>,</span>
<span>                                      <span class="va">...</span><span class="op">)</span><span class="op">{</span></span>
<span>  <span class="co"># Validations</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot</a></span><span class="op">(</span><span class="st">"There is no espace between y and ~"</span> <span class="op">=</span> <span class="va">formula</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html">%like%</a></span> <span class="st">"[A-Za-z]+ "</span><span class="op">)</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/stopifnot.html">stopifnot</a></span><span class="op">(</span><span class="st">"loo_split must be a data.table object"</span> <span class="op">=</span> <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/as.data.table.html">is.data.table</a></span><span class="op">(</span><span class="va">loo_split</span><span class="op">)</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">predictor</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">sub</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">" .+"</span>, replacement <span class="op">=</span> <span class="st">""</span>, <span class="va">formula</span><span class="op">)</span></span>
<span>  <span class="va">formula_to_fit</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/formula.html">as.formula</a></span><span class="op">(</span><span class="va">formula</span><span class="op">)</span></span>
<span>  </span>
<span>  <span class="va">Results</span> <span class="op">&lt;-</span></span>
<span>    <span class="va">loo_split</span><span class="op">[</span>, <span class="fu">training</span><span class="op">(</span><span class="va">splits</span><span class="op">[[</span><span class="fl">1L</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"id"</span></span>
<span>    <span class="op">]</span><span class="op">[</span>, <span class="fu">.</span><span class="op">(</span>model <span class="op">=</span> <span class="fu">.</span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">formula_to_fit</span>, data <span class="op">=</span> <span class="va">.SD</span><span class="op">)</span><span class="op">)</span><span class="op">)</span>,</span>
<span>      by <span class="op">=</span> <span class="st">"id"</span></span>
<span>    <span class="op">]</span><span class="op">[</span><span class="va">loo_split</span><span class="op">[</span>, <span class="fu">testing</span><span class="op">(</span><span class="va">splits</span><span class="op">[[</span><span class="fl">1L</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>, by <span class="op">=</span> <span class="st">"id"</span><span class="op">]</span>,</span>
<span>      on <span class="op">=</span> <span class="st">"id"</span></span>
<span>    <span class="op">]</span><span class="op">[</span>, <span class="va">.pred</span> <span class="op">:=</span> <span class="fu"><a href="https://rdrr.io/r/stats/predict.html">predict</a></span><span class="op">(</span><span class="va">model</span><span class="op">[[</span><span class="fl">1L</span><span class="op">]</span><span class="op">]</span>, newdata <span class="op">=</span> <span class="va">.SD</span><span class="op">)</span>,</span>
<span>      by <span class="op">=</span> <span class="st">"id"</span></span>
<span>    <span class="op">]</span><span class="op">[</span>,  <span class="fu">metric_function</span><span class="op">(</span><span class="va">.SD</span>, truth <span class="op">=</span> <span class="op">!</span><span class="op">!</span><span class="va">predictor</span>, estimate <span class="op">=</span> <span class="va">.pred</span>, <span class="va">...</span><span class="op">)</span> <span class="op">]</span></span>
<span> </span>
<span>  <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setDT.html">setDT</a></span><span class="op">(</span><span class="va">Results</span><span class="op">)</span></span>
<span>  </span>
<span>  </span>
<span>  <span class="kw">if</span><span class="op">(</span><span class="va">formula</span> <span class="op"><a href="https://Rdatatable.gitlab.io/data.table/reference/like.html">%like%</a></span> <span class="st">"degree"</span><span class="op">)</span><span class="op">{</span></span>
<span>    </span>
<span>    <span class="va">degree</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/grep.html">gsub</a></span><span class="op">(</span>pattern <span class="op">=</span> <span class="st">"[ A-Za-z,=\\~()]"</span>, replacement <span class="op">=</span> <span class="st">""</span>, <span class="va">formula</span><span class="op">)</span></span>
<span>    </span>
<span>    <span class="va">Results</span> <span class="op">&lt;-</span> </span>
<span>      <span class="va">Results</span><span class="op">[</span>,<span class="fu">.</span><span class="op">(</span>degree <span class="op">=</span> <span class="va">degree</span>, </span>
<span>                <span class="va">.metric</span>, </span>
<span>                <span class="va">.estimator</span>, </span>
<span>                <span class="va">.estimate</span><span class="op">)</span><span class="op">]</span></span>
<span>    </span>
<span>  <span class="op">}</span></span>
<span>  </span>
<span>  <span class="kw"><a href="https://rdrr.io/r/base/function.html">return</a></span><span class="op">(</span><span class="va">Results</span><span class="op">)</span></span>
<span>    </span>
<span><span class="op">}</span></span>
<span></span>
<span></span>
<span><span class="co"># Creating the rplit object</span></span>
<span><span class="va">SimulatedDtSplit</span> <span class="op">&lt;-</span> <span class="fu">loo_cv</span><span class="op">(</span><span class="va">SimulatedDt</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Transforming to data.table</span></span>
<span><span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/setDT.html">setDT</a></span><span class="op">(</span><span class="va">SimulatedDtSplit</span><span class="op">)</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste0</a></span><span class="op">(</span><span class="st">"y ~ poly(x, degree="</span>, <span class="fl">1</span><span class="op">:</span><span class="fl">4</span>, <span class="st">")"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/lapply.html">lapply</a></span><span class="op">(</span><span class="va">collect_loo_testing_error</span>,</span>
<span>         loo_split <span class="op">=</span> <span class="va">SimulatedDtSplit</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu"><a href="https://Rdatatable.gitlab.io/data.table/reference/rbindlist.html">rbindlist</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>   degree .metric .estimator .estimate
   &lt;char&gt;  &lt;char&gt;     &lt;char&gt;     &lt;num&gt;
1:      1    rmse   standard 2.6996595
2:      2    rmse   standard 0.9682064
3:      3    rmse   standard 0.9780705
4:      4    rmse   standard 0.9766805</code></pre>
</div>
</div>
</section><section id="d-4" class="level4"><h4 class="anchored" data-anchor-id="d-4">D</h4>
<p><strong>(D)</strong> Repeat (c) using another random seed, and report your results. Are your results the same as what you got in (c)? Why?</p>
<p>The results will be the same as LOOCV don’t perform any random process.</p>
</section><section id="e-2" class="level4"><h4 class="anchored" data-anchor-id="e-2">E</h4>
<p><strong>(E)</strong> Which of the models in (c) had the smallest LOOCV error? Is this what you expected? Explain your answer.</p>
<p>The model with the lowest test error is the model using as a base the second grade evacuation. It’s what we were expecting, as we know the true form of the original function it’s a second degree one and adding more flexibility to the model just over-fit it.</p>
</section><section id="f-1" class="level4"><h4 class="anchored" data-anchor-id="f-1">F</h4>
<p><strong>(F)</strong> Comment on the statistical signiﬁcance of the coeﬃcient estimates that results from ﬁtting each of the models in (c) using least squares. Do these results agree with the conclusions drawn based on the cross-validation results?</p>
<p>For the first model the predictor it’s significant.</p>
<div class="cell">
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op">(</span><span class="va">x</span>, degree<span class="op">=</span> <span class="fl">1</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">SimulatedDt</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ poly(x, degree = 1), data = SimulatedDt)

Residuals:
    Min      1Q  Median      3Q     Max 
-9.5161 -0.6800  0.6812  1.5491  3.8183 

Coefficients:
                    Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)           -1.550      0.260  -5.961 3.95e-08 ***
poly(x, degree = 1)    6.189      2.600   2.380   0.0192 *  
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.6 on 98 degrees of freedom
Multiple R-squared:  0.05465,   Adjusted R-squared:  0.045 
F-statistic: 5.665 on 1 and 98 DF,  p-value: 0.01924</code></pre>
</div>
</div>
<p>For the second model the predictors are very significant.</p>
<div class="cell">
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op">(</span><span class="va">x</span>, degree<span class="op">=</span> <span class="fl">2</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">SimulatedDt</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ poly(x, degree = 2), data = SimulatedDt)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.9650 -0.6254 -0.1288  0.5803  2.2700 

Coefficients:
                     Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)           -1.5500     0.0958  -16.18  &lt; 2e-16 ***
poly(x, degree = 2)1   6.1888     0.9580    6.46 4.18e-09 ***
poly(x, degree = 2)2 -23.9483     0.9580  -25.00  &lt; 2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.958 on 97 degrees of freedom
Multiple R-squared:  0.873, Adjusted R-squared:  0.8704 
F-statistic: 333.3 on 2 and 97 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>The additional element of the function is not significant.</p>
<div class="cell">
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op">(</span><span class="va">x</span>, degree<span class="op">=</span> <span class="fl">3</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">SimulatedDt</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ poly(x, degree = 3), data = SimulatedDt)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.9765 -0.6302 -0.1227  0.5545  2.2843 

Coefficients:
                      Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)           -1.55002    0.09626 -16.102  &lt; 2e-16 ***
poly(x, degree = 3)1   6.18883    0.96263   6.429 4.97e-09 ***
poly(x, degree = 3)2 -23.94830    0.96263 -24.878  &lt; 2e-16 ***
poly(x, degree = 3)3   0.26411    0.96263   0.274    0.784    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9626 on 96 degrees of freedom
Multiple R-squared:  0.8731,    Adjusted R-squared:  0.8691 
F-statistic: 220.1 on 3 and 96 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>The additional element of the function is not significant.</p>
<div class="cell">
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/lm.html">lm</a></span><span class="op">(</span><span class="va">y</span> <span class="op">~</span> <span class="fu"><a href="https://rdrr.io/r/stats/poly.html">poly</a></span><span class="op">(</span><span class="va">x</span>, degree<span class="op">=</span> <span class="fl">4</span><span class="op">)</span>, data <span class="op">=</span> <span class="va">SimulatedDt</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>    <span class="fu"><a href="https://rdrr.io/r/base/summary.html">summary</a></span><span class="op">(</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = y ~ poly(x, degree = 4), data = SimulatedDt)

Residuals:
    Min      1Q  Median      3Q     Max 
-2.0550 -0.6212 -0.1567  0.5952  2.2267 

Coefficients:
                      Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)           -1.55002    0.09591 -16.162  &lt; 2e-16 ***
poly(x, degree = 4)1   6.18883    0.95905   6.453 4.59e-09 ***
poly(x, degree = 4)2 -23.94830    0.95905 -24.971  &lt; 2e-16 ***
poly(x, degree = 4)3   0.26411    0.95905   0.275    0.784    
poly(x, degree = 4)4   1.25710    0.95905   1.311    0.193    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9591 on 95 degrees of freedom
Multiple R-squared:  0.8753,    Adjusted R-squared:  0.8701 
F-statistic: 166.7 on 4 and 95 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section></section><section id="section-8" class="level3"><h3 class="anchored" data-anchor-id="section-8">9</h3>
<p><strong>9.</strong> We will now consider the Boston housing data set, from the <code>ISLR2</code> library.</p>
<section id="a-6" class="level4"><h4 class="anchored" data-anchor-id="a-6">A</h4>
<p><strong>(A)</strong> Based on this data set, provide an estimate for the population mean of <code>medv</code>. Call this estimate <span class="math inline">\(\hat{\mu}\)</span>.</p>
<div class="cell">
<div class="sourceCode" id="cb47"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">BostonMedvMean</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/mean.html">mean</a></span><span class="op">(</span><span class="fu">ISLR2</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ISLR2/man/Boston.html">Boston</a></span><span class="op">$</span><span class="va">medv</span><span class="op">)</span></span>
<span></span>
<span><span class="va">BostonMedvMean</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 22.53281</code></pre>
</div>
</div>
</section><section id="b-6" class="level4"><h4 class="anchored" data-anchor-id="b-6">B</h4>
<p><strong>(B)</strong> Provide an estimate of the standard error of <span class="math inline">\(\hat{\mu}\)</span>. Interpret this result. <em>Hint: We can compute the standard error of the sample mean by dividing the sample standard deviation by the square root of the number of observations.</em></p>
<div class="cell">
<div class="sourceCode" id="cb49"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="va">BostonMedvSeEstimation</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="fu">ISLR2</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ISLR2/man/Boston.html">Boston</a></span><span class="op">$</span><span class="va">medv</span><span class="op">)</span><span class="op">/</span><span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">sqrt</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/nrow.html">nrow</a></span><span class="op">(</span><span class="fu">ISLR2</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ISLR2/man/Boston.html">Boston</a></span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</div>
</section><section id="c-5" class="level4"><h4 class="anchored" data-anchor-id="c-5">C</h4>
<p><strong>(C)</strong> Now estimate the standard error of <span class="math inline">\(\hat{\mu}\)</span>. using the bootstrap. How does this compare to your answer from (b)?</p>
<p>Both estimations are really close.</p>
<div class="cell">
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Using the infer package as just need to estimate</span></span>
<span><span class="co"># a single number</span></span>
<span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">123</span><span class="op">)</span></span>
<span></span>
<span><span class="va">BostonMedvBootstrap</span> <span class="op">&lt;-</span></span>
<span>  <span class="fu">ISLR2</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ISLR2/man/Boston.html">Boston</a></span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">specify</span><span class="op">(</span><span class="va">medv</span> <span class="op">~</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">generate</span><span class="op">(</span>reps <span class="op">=</span> <span class="fl">5000</span>, type <span class="op">=</span> <span class="st">"bootstrap"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">calculate</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"mean"</span><span class="op">)</span> </span>
<span></span>
<span><span class="va">BostonMedvBootstrap</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span>Se_bootstrap <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">stat</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">mutate</span><span class="op">(</span>Se_estimation <span class="op">=</span> <span class="va">BostonMedvSeEstimation</span>,</span>
<span>         diff <span class="op">=</span> <span class="va">Se_bootstrap</span> <span class="op">-</span> <span class="va">Se_estimation</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 3
  Se_bootstrap Se_estimation    diff
         &lt;dbl&gt;         &lt;dbl&gt;   &lt;dbl&gt;
1        0.414         0.409 0.00481</code></pre>
</div>
</div>
</section><section id="d-5" class="level4"><h4 class="anchored" data-anchor-id="d-5">D</h4>
<p><strong>(D)</strong> Based on your bootstrap estimate from (c), provide a 95 % conﬁdence interval for the mean of <code>medv</code>. Compare it to the results obtained using <code>t.test(Boston$medv)</code>. <em>Hint: You can approximate a 95 % conﬁdence interval using the formula</em> [<span class="math inline">\(\hat{\mu} - 2\text{SE}(\hat{\mu}), \hat{\mu} + 2\text{SE}(\hat{\mu})\)</span> <em>.</em></p>
<div class="cell">
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">get_ci</span><span class="op">(</span><span class="va">BostonMedvBootstrap</span>, </span>
<span>       point_estimate <span class="op">=</span> <span class="va">BostonMedvMean</span>,</span>
<span>       level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>       type <span class="op">=</span> <span class="st">"se"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  lower_ci upper_ci
     &lt;dbl&gt;    &lt;dbl&gt;
1     21.7     23.3</code></pre>
</div>
</div>
</section><section id="e-3" class="level4"><h4 class="anchored" data-anchor-id="e-3">E</h4>
<p><strong>(E)</strong> Based on this data set, provide an estimate, <span class="math inline">\(\hat{\mu}_{med}\)</span>, for the median value of <code>medv</code> in the population.</p>
<div class="cell">
<div class="sourceCode" id="cb54"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/median.html">median</a></span><span class="op">(</span><span class="fu">ISLR2</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ISLR2/man/Boston.html">Boston</a></span><span class="op">$</span><span class="va">medv</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>[1] 21.2</code></pre>
</div>
</div>
</section><section id="f-2" class="level4"><h4 class="anchored" data-anchor-id="f-2">F</h4>
<p><strong>(F)</strong> We now would like to estimate the standard error of <span class="math inline">\(\hat{\mu}_{med}\)</span>. Unfortunately, there is no simple formula for computing the standard error of the median. Instead, estimate the standard error of the median using the bootstrap. Comment on your ﬁndings.</p>
<p>The intervals for the median seams to be a little bit lower than the ones for the average. It seems the distributions of <code>medv</code> is right skewed.</p>
<div class="cell">
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">77</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ISLR2</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ISLR2/man/Boston.html">Boston</a></span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">specify</span><span class="op">(</span><span class="va">medv</span> <span class="op">~</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">generate</span><span class="op">(</span>reps <span class="op">=</span> <span class="fl">5000</span>, type <span class="op">=</span> <span class="st">"bootstrap"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">calculate</span><span class="op">(</span>stat <span class="op">=</span> <span class="st">"median"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">get_ci</span><span class="op">(</span>level <span class="op">=</span> <span class="fl">0.95</span>,</span>
<span>         type <span class="op">=</span> <span class="st">"percentile"</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 2
  lower_ci upper_ci
     &lt;dbl&gt;    &lt;dbl&gt;
1     20.5     21.9</code></pre>
</div>
</div>
<p>Right skewed has been confirmed.</p>
<div class="cell">
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu">ggplot</span><span class="op">(</span><span class="fu">ISLR2</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ISLR2/man/Boston.html">Boston</a></span>, <span class="fu">aes</span><span class="op">(</span><span class="va">medv</span><span class="op">)</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">geom_histogram</span><span class="op">(</span>fill <span class="op">=</span> <span class="st">"dodgerblue3"</span>, </span>
<span>                 alpha <span class="op">=</span> <span class="fl">0.9</span>, bins <span class="op">=</span> <span class="fl">15</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme_light</span><span class="op">(</span><span class="op">)</span><span class="op">+</span></span>
<span>  <span class="fu">theme</span><span class="op">(</span>panel.grid <span class="op">=</span> <span class="fu">element_blank</span><span class="op">(</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output-display">
<p><img src="05-execises_files/figure-html/unnamed-chunk-33-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section><section id="g-1" class="level4"><h4 class="anchored" data-anchor-id="g-1">G</h4>
<p><strong>(G)</strong> Based on this data set, provide an estimate for the tenth percentile of <code>medv</code> in Boston census tracts. Call this quantity <span class="math inline">\(\hat{\mu}_{0.1}\)</span>. (You can use the <code><a href="https://rdrr.io/r/stats/quantile.html">quantile()</a></code> function.)</p>
<div class="cell">
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="fu">ISLR2</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ISLR2/man/Boston.html">Boston</a></span><span class="op">$</span><span class="va">medv</span>, probs <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code>  10% 
12.75 </code></pre>
</div>
</div>
</section><section id="h-1" class="level4"><h4 class="anchored" data-anchor-id="h-1">H</h4>
<p><strong>(H)</strong> Use the bootstrap to estimate the standard error of <span class="math inline">\(\hat{\mu}_{0.1}\)</span>. Comment on your ﬁndings.</p>
<p>The standard error is slightly larger relative to <span class="math inline">\(\hat{\mu}_{0.1}\)</span>, but it is still small.</p>
<div class="cell">
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">77</span><span class="op">)</span></span>
<span></span>
<span><span class="fu">ISLR2</span><span class="fu">::</span><span class="va"><a href="https://rdrr.io/pkg/ISLR2/man/Boston.html">Boston</a></span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">specify</span><span class="op">(</span><span class="va">medv</span> <span class="op">~</span> <span class="cn">NULL</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">generate</span><span class="op">(</span>reps <span class="op">=</span> <span class="fl">5000</span>, type <span class="op">=</span> <span class="st">"bootstrap"</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">group_by</span><span class="op">(</span><span class="va">replicate</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span>medv_tenth_percentile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/quantile.html">quantile</a></span><span class="op">(</span><span class="va">medv</span>, probs <span class="op">=</span> <span class="fl">0.1</span><span class="op">)</span><span class="op">)</span> <span class="op">|&gt;</span></span>
<span>  <span class="fu">summarize</span><span class="op">(</span>se_medv_tenth_percentile <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/stats/sd.html">sd</a></span><span class="op">(</span><span class="va">medv_tenth_percentile</span><span class="op">)</span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-stdout">
<pre><code># A tibble: 1 × 1
  se_medv_tenth_percentile
                     &lt;dbl&gt;
1                    0.507</code></pre>
</div>
</div>


</section></section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    target: function(trigger) {
      return trigger.previousElementSibling;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./04-execises.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text">04 - Classification</span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./11-execises.html" class="pagination-link">
        <span class="nav-page-text">11 - Survival Analysis and Censored Data</span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">Non official solitions of An Introduction to Statistical Learning Second Edition</div>   
    <div class="nav-footer-right">This book was built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>


</body></html>