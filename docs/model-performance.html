<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">
<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">
<meta name="author" content="Angel Feliz">
<title>An Introduction to Statistical Learning (Non Official Solution Book) - 3&nbsp; Understanding model performance</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>

<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<link href="./resampling-methods.html" rel="next">
<link href="./missing-values.html" rel="prev">
<link href="./cover.png" rel="icon" type="image/png">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light"><script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 20,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script><link rel="stylesheet" href="summary-format.css">
</head>
<body class="nav-sidebar floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top"><nav class="navbar navbar-expand-lg navbar-dark "><div class="navbar-container container-fluid">
      <div class="navbar-brand-container">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">An Introduction to Statistical Learning (Non Official Solution Book)</span>
    </a>
  </div>
        <div class="quarto-navbar-tools ms-auto">
    <a href="https://github.com/AngelFelizR/ISL-Solutuon-Book" rel="" title="Source Code" class="quarto-navigation-tool px-1" aria-label="Source Code"><i class="bi bi-github"></i></a>
  <a href="" class="quarto-reader-toggle quarto-navigation-tool px-1" onclick="window.quartoToggleReader(); return false;" title="Toggle reader mode">
  <div class="quarto-reader-toggle-btn">
  <i class="bi"></i>
  </div>
</a>
</div>
          <div id="quarto-search" class="" title="Search"></div>
      </div> <!-- /container-fluid -->
    </nav><nav class="quarto-secondary-nav"><div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
      <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="./modeling-process.html">Teorical Summary</a></li><li class="breadcrumb-item"><a href="./model-performance.html"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Understanding model performance</span></a></li></ol></nav>
      <a class="flex-grow-1" role="button" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
      </a>
      <button type="button" class="btn quarto-search-button" aria-label="" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav></header><!-- content --><div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal sidebar-navigation floating overflow-auto"><div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./index.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">Preface</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true">
 <span class="menu-text">Teorical Summary</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./modeling-process.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">1</span>&nbsp; <span class="chapter-title">Strategy to implement machine learning solutions</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./missing-values.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Dealing with missingness</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./model-performance.html" class="sidebar-item-text sidebar-link active">
 <span class="menu-text"><span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Understanding model performance</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./resampling-methods.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Resampling methods</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./generalized-linear-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">5</span>&nbsp; <span class="chapter-title">Generalized linear models (GLM)</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./generative-classification-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">6</span>&nbsp; <span class="chapter-title">Generative Models for Classiﬁcation</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./flexible-regression.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">7</span>&nbsp; <span class="chapter-title">Flexible Regression Models</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./non-parametric-models.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">8</span>&nbsp; <span class="chapter-title">Non-parametric Methods</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./survival-analysis.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">9</span>&nbsp; <span class="chapter-title">Time-event (Survival) Analysis and Censored Data</span></span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./unsupervised-learning.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text"><span class="chapter-number">10</span>&nbsp; <span class="chapter-title">Unsupervised Learning</span></span></a>
  </div>
</li>
      </ul>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true">
 <span class="menu-text">Exercise Solutions</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">
<li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./02-execises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">02 - Statistical Learning</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./03-execises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">03 - Linear Regression</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./04-execises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">04 - Classification</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./05-execises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">05 - Resampling Methods</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="./11-execises.html" class="sidebar-item-text sidebar-link">
 <span class="menu-text">11 - Survival Analysis and Censored Data</span></a>
  </div>
</li>
      </ul>
</li>
    </ul>
</div>
</nav><div id="quarto-sidebar-glass" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar,#quarto-sidebar-glass"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active"><h2 id="toc-title">Table of contents</h2>
   
  <ul>
<li><a href="#reducible-and-irreducible-error" id="toc-reducible-and-irreducible-error" class="nav-link active" data-scroll-target="#reducible-and-irreducible-error"><span class="header-section-number">3.1</span> Reducible and irreducible error</a></li>
  <li><a href="#types-of-models" id="toc-types-of-models" class="nav-link" data-scroll-target="#types-of-models"><span class="header-section-number">3.2</span> Types of models</a></li>
  <li>
<a href="#evaluating-model-performance" id="toc-evaluating-model-performance" class="nav-link" data-scroll-target="#evaluating-model-performance"><span class="header-section-number">3.3</span> Evaluating model performance</a>
  <ul>
<li><a href="#regression-models" id="toc-regression-models" class="nav-link" data-scroll-target="#regression-models"><span class="header-section-number">3.3.1</span> Regression models</a></li>
  <li><a href="#classification-models" id="toc-classification-models" class="nav-link" data-scroll-target="#classification-models"><span class="header-section-number">3.3.2</span> Classification models</a></li>
  </ul>
</li>
  </ul></nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content"><header id="title-block-header" class="quarto-title-block default"><div class="quarto-title">
<h1 class="title">
<span class="chapter-number">3</span>&nbsp; <span class="chapter-title">Understanding model performance</span>
</h1>
</div>



<div class="quarto-title-meta">

    
  
    
  </div>
  

</header><section id="reducible-and-irreducible-error" class="level2" data-number="3.1"><h2 data-number="3.1" class="anchored" data-anchor-id="reducible-and-irreducible-error">
<span class="header-section-number">3.1</span> Reducible and irreducible error</h2>
<p>The goal when we are analyzing data is to find a function that based on some Predictors and some random noise could explain the Response variable.</p>
<p><span class="math display">\[
Y = f(X) + \epsilon
\]</span></p>
<p><strong><span class="math inline">\(\epsilon\)</span></strong> represent the <strong>random error</strong> and correspond to the <strong>irreducible error</strong> as it cannot be predicted using the Predictors in regression models. It would have a mean of 0 unless are missing some relevant Predictors.</p>
<p>In classification models, the <strong>irreducible error</strong> is represented by the <strong>Bayes Error Rate</strong>.</p>
<p><span class="math display">\[
1 -  E\left(
     \underset{j}{max}Pr(Y = j|X)
     \right)
\]</span></p>
<p>An error is <strong>reducible</strong> if we can improve the accuracy of <span class="math inline">\(\hat{f}\)</span> by using a most appropriate statistical learning technique to estimate <span class="math inline">\(f\)</span>.</p>
<p>The challenge to achieve that goal it’s that we don’t at the beginning how much of the error correspond to each type.</p>
<p><span class="math display">\[
\begin{split}
E(Y-\hat{Y})^2 &amp; = E[f(X) + \epsilon - \hat{f}(X)]^2 \\
               &amp; = \underbrace{[f(X)- \hat{f}(X)]^2}_\text{Reducible} +
                   \underbrace{Var(\epsilon)}_\text{Irredicible}
\end{split}
\]</span></p>
<p>The reducible error can be also spitted in two parts:</p>
<ul>
<li><p><strong>Variance</strong> refers to the amount by which <span class="math inline">\(\hat{f}\)</span> would change if we estimate it using a different <strong>training data set</strong>. If a method has high variance then small changes in the training data can result in large changes of <span class="math inline">\(\hat{f}\)</span>.</p></li>
<li><p><strong>Squared bias</strong> refers to the error that is introduced by approximating a real-life problem, which may be extremely complicated, by a much simpler model as for example a linear model.<em>Bias</em> is the difference between the expected (or average) prediction of our model and the correct value which we are trying to predict.</p></li>
</ul>
<p><span class="math display">\[
E(y_{0} - \hat{f}(x_{0}))^2 =
Var(\hat{f}(x_{0})) +
[Bias(\hat{f}(x_{0}))]^2 +
Var(\epsilon)
\]</span></p>
<div class="callout callout-style-simple callout-note">
<div class="callout-body d-flex">
<div class="callout-icon-container">
<i class="callout-icon"></i>
</div>
<div class="callout-body-container">
<p>Our challenge lies in ﬁnding a method for which both the variance and the squared bias are low.</p>
</div>
</div>
</div>
</section><section id="types-of-models" class="level2" data-number="3.2"><h2 data-number="3.2" class="anchored" data-anchor-id="types-of-models">
<span class="header-section-number">3.2</span> Types of models</h2>
<ul>
<li>
<strong>Parametric methods</strong>
<ol type="1">
<li>Make an assumption about the functional form. For example, assuming linearity.</li>
<li>Estimate a small number parameters based on training data.</li>
<li>Are easy to interpret.</li>
<li>Tend to outperform non-parametric approaches when there is a small number of observations per predictor.</li>
</ol>
</li>
<li>
<strong>Non-parametric methods</strong>
<ol type="1">
<li>Don’t make an assumption about the functional form, to accurately ﬁt a wider range of possible shapes for <span class="math inline">\(f\)</span>.</li>
<li>Need a large number of observations in order to obtain an accurate estimate for <span class="math inline">\(f\)</span>.</li>
<li>The data analyst must select a level of smoothness (degrees of freedom).</li>
</ol>
</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="img/01-accuracy-vs-interpretability.png" class="img-fluid figure-img"></p>
</figure>
</div>
</section><section id="evaluating-model-performance" class="level2" data-number="3.3"><h2 data-number="3.3" class="anchored" data-anchor-id="evaluating-model-performance">
<span class="header-section-number">3.3</span> Evaluating model performance</h2>
<p>To evaluate how good works a models we need to split the available data in two parts.</p>
<ul>
<li>
<strong>Training data</strong>: Used to fit the model.</li>
<li>
<strong>Test data</strong>: Used to confirm how well the model works with new data.</li>
</ul>
<section id="regression-models" class="level3" data-number="3.3.1"><h3 data-number="3.3.1" class="anchored" data-anchor-id="regression-models">
<span class="header-section-number">3.3.1</span> Regression models</h3>
<ul>
<li>
<strong>Ground Truth vs.&nbsp;Predicts Plot</strong>: In this plot we represent the <em>predictions on the x-axis</em> and the <em>outcome on the y-axis</em> in a <strong>scatted plot</strong> with a line with <strong>slope = 1</strong>. If the model predicted perfectly, all the points would be along this line. If you see regions where the points are entirely above or below the line it demonstrates that <strong>the errors are correlated with the value of the outcome</strong>. Some possible problems could be:
<ul>
<li>Don’t having all the important variables in your model</li>
<li>You need an algorithm that can find more complex relationships in the data</li>
</ul>
</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="img/69-ground-truth-vs-predictions-plot.png" class="img-fluid figure-img"></p>
</figure>
</div>
<ul>
<li>
<strong>Residual Plots</strong>: It plots the residuals (<span class="math inline">\(y_i - \hat{y}_i\)</span>) against the predictions (<span class="math inline">\(\hat{y}_i\)</span>).In a model with no systematic errors, the errors will be evenly distributed between positive and negative, but When there are systematic errors, there will be <strong>clusters of all positive or all negative residuals</strong>.</li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="img/70-residual-plots.png" class="img-fluid figure-img"></p>
</figure>
</div>
<ul>
<li>
<strong>Gain curve plot</strong>: It is useful when <strong>sorting the instances</strong> is more important than predicting the exact outcome value like happens when <strong>predicting probabilities</strong>, where:
<ul>
<li>The <strong>x-axis</strong> shows the <strong>fraction of total houses</strong> as sorted by the model.</li>
<li>The <strong>y-axis</strong> shows the fraction of total accumulated outcome magnitude.</li>
<li>The <strong>diagonal line</strong> represents the gain curve if the houses are <strong>sorted randomly</strong>. T</li>
<li>The <strong>wizard curve</strong> represents what a <strong>perfect model</strong> would trace out.</li>
<li>The blue curve is what <strong>our model</strong> traces out.</li>
<li>A <strong>relative gini coefficient</strong> close to one shows that the model correctly sorts high unemployment situations from lower ones.</li>
</ul>
</li>
</ul>
<div class="cell">
<details><summary>Code</summary><div class="sourceCode" id="cb1"><pre class="downlit sourceCode r code-with-copy"><code class="sourceCode R"><span><span class="co"># Creating a data.frame</span></span>
<span><span class="fu"><a href="https://rdrr.io/r/base/Random.html">set.seed</a></span><span class="op">(</span><span class="fl">34903490</span><span class="op">)</span></span>
<span><span class="va">y</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span> <span class="op">+</span> <span class="fl">0.1</span></span>
<span><span class="va">x</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/MathFun.html">abs</a></span><span class="op">(</span><span class="va">y</span> <span class="op">+</span> <span class="fl">0.5</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/stats/Normal.html">rnorm</a></span><span class="op">(</span><span class="fl">20</span><span class="op">)</span><span class="op">)</span></span>
<span><span class="va">frm</span> <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html">data.frame</a></span><span class="op">(</span>model<span class="op">=</span><span class="va">x</span>, value<span class="op">=</span><span class="va">y</span><span class="op">)</span></span>
<span></span>
<span><span class="co"># Getting the predicted top 25% most valuable points</span></span>
<span><span class="co"># as sorted by the model</span></span>
<span><span class="va">gainx</span> <span class="op">=</span> <span class="fl">0.25</span>  </span>
<span></span>
<span><span class="co"># Creating a function to calculate the label for the annotated point</span></span>
<span><span class="va">labelfun</span> <span class="op">=</span> <span class="kw">function</span> <span class="op">(</span><span class="va">gx</span>, <span class="va">gy</span><span class="op">)</span> <span class="op">{</span></span>
<span>  <span class="va">pctx</span> <span class="op">=</span> <span class="va">gx</span><span class="op">*</span><span class="fl">100</span></span>
<span>  <span class="va">pcty</span> <span class="op">=</span> <span class="va">gy</span><span class="op">*</span><span class="fl">100</span></span>
<span></span>
<span>  <span class="fu"><a href="https://rdrr.io/r/base/paste.html">paste</a></span><span class="op">(</span><span class="st">"The predicted top "</span>, <span class="va">pctx</span>, <span class="st">"% most valuable points by the model\n"</span>,</span>
<span>        <span class="st">"are "</span>, <span class="va">pcty</span>, <span class="st">"% of total actual value"</span>, sep<span class="op">=</span><span class="st">''</span><span class="op">)</span></span>
<span><span class="op">}</span></span>
<span></span>
<span><span class="fu">WVPlots</span><span class="fu">::</span><span class="fu"><a href="https://winvector.github.io/WVPlots//reference/GainCurvePlotWithNotation.html">GainCurvePlotWithNotation</a></span><span class="op">(</span></span>
<span>  <span class="va">frm</span>,</span>
<span>  xvar <span class="op">=</span> <span class="st">"model"</span>,</span>
<span>  truthVar <span class="op">=</span> <span class="st">"value"</span>,</span>
<span>  title <span class="op">=</span> <span class="st">"Example Gain Curve with annotation"</span>,</span>
<span>  gainx <span class="op">=</span> <span class="va">gainx</span>,</span>
<span>  labelfun <span class="op">=</span> <span class="va">labelfun</span></span>
<span><span class="op">)</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
</details><div class="cell-output-display">
<p><img src="model-performance_files/figure-html/unnamed-chunk-1-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<ul>
<li>
<strong>Test Root Mean Squared Error (RMSE)</strong>: It takes the square root of the MSE metric so that your error is in the same units as your response variable.<strong>Objective: minimize</strong>
</li>
</ul>
<p>To know if the <strong>RMSE of our model</strong> is high or low can compare it with the <strong>standard deviation of the outcome</strong> (<code>sd(y)</code>), then if the <em>RMSE being smaller than the standard deviation</em> that demonstrates that <em>the model tends to estimate better than simply taking the average</em>.</p>
<p><span class="math display">\[
RMSE = \sqrt{\frac{1}{n} \sum_{i=1}^n (y_i - \hat{y}_i)^2}
\]</span></p>
<ul>
<li>
<strong>Mean squared error (MSE)</strong>: The squared component results in larger errors having larger penalties. <strong>Objective: minimize</strong>
</li>
</ul>
<p><span class="math display">\[
MSE = \frac{1}{n} \sum_{i=1}^n (y_i - \hat{y}_i)^2
\]</span></p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="img/01-Training-vs-Test-Error.png" class="img-fluid figure-img"></p>
</figure>
</div>
<ul>
<li>
<span class="math inline">\(R^2\)</span>: This is a popular metric that represents the proportion of the variance in the dependent variable that is predictable from the independent variable(s). But if have too many limitations and You should not place too much emphasis on this metric. <strong>Objective: minimize</strong>
</li>
</ul>
<p>$$</p>
<p>R^2 = 1 - {_} $$</p>
<ul>
<li>
<strong>Root mean squared logarithmic error (RMSLE)</strong>: When your response variable has a wide range of values, large response values with large errors can dominate the MSE/RMSE metric. RMSLE minimizes this impact so that small response values with large errors can have just as meaningful of an impact as large response values with large errors. <strong>Objective: minimize</strong>
</li>
</ul>
<p><span class="math display">\[
\text{RMSLE} = \sqrt{\frac{1}{n} \sum_{i=i}^n (\log{(y_i + 1)} - \log{(\hat{y}_i + 1)})^2}
\]</span></p>
<ul>
<li>
<strong>Mean absolute error (MAE)</strong>: Similar to MSE but rather than squaring, it just takes the mean absolute difference between the actual and predicted values. <strong>Objective: minimize</strong>
</li>
</ul>
<p><span class="math display">\[
\text{MAE} = \frac{1}{n} \sum_{i=1}^n (|y_i - \hat{y}_i|)
\]</span></p>
<ul>
<li>
<strong>Deviance</strong>: If the response variable distribution is Gaussian, then it will be approximately equal to MSE. When not, it usually gives a more useful estimate of error. It is often used with <em>classification models</em> and compares a saturated model (i.e.&nbsp;fully featured model) to an unsaturated model (i.e.&nbsp;intercept only or average) to provide the degree to which a model explains the variation in a set of data. <strong>Objective: minimize</strong>
</li>
</ul>
<p><br></p>
</section><section id="classification-models" class="level3" data-number="3.3.2"><h3 data-number="3.3.2" class="anchored" data-anchor-id="classification-models">
<span class="header-section-number">3.3.2</span> Classification models</h3>
<ul>
<li>
<strong>Error (misclassification) rate</strong>: It represents the overall error. <strong>Objective: minimize</strong>
</li>
</ul>
<p><span class="math display">\[
I(y_{0} \neq \hat{y}_{0}) =
\begin{cases}
    1 &amp; \text{If } y_{0} \neq \hat{y}_{0} \\
    0 &amp; \text{If } y_{0} = \hat{y}_{0}
\end{cases}
\]</span></p>
<p><span class="math display">\[
\text{Ave}(I(y_{0} \neq \hat{y}_{0}))
\]</span></p>
<ul>
<li>
<strong>Mean per class error</strong>: This is the average error rate for each class. If your classes are balanced this will be identical to misclassification. <strong>Objective: minimize</strong>
</li>
</ul>
<p><span class="math display">\[
\begin{split}
\text{Ave}(&amp; \text{Ave}(I(y_{0} \neq \hat{y}_{0}))_1, \\
           &amp; \text{Ave}(I(y_{0} \neq \hat{y}_{0}))_2, \\
           &amp; \dots, \\
           &amp; \text{Ave}(I(y_{0} \neq \hat{y}_{0}))_\text{n-class})
\end{split}
\]</span></p>
<ul>
<li>
<strong>Mean squared error (MSE)</strong>: Computes the distance from 1 to the probability assign by the model to the correct category (<span class="math inline">\(\hat{p}\)</span>). The squared component results in large differences in probabilities for the true class having larger penalties. <strong>Objective: minimize</strong>
</li>
</ul>
<p><span class="math display">\[
MSE = \frac{1}{n} \sum_{i=1}^n (1 - \hat{p}_i)^2
\]</span></p>
<ul>
<li><p><strong>Cross-entropy (aka Log Loss or Deviance)</strong>: Similar to MSE but it incorporates a log of the predicted probability multiplied by the true class, it disproportionately punishes predictions where we predict a small probability for the true class (<em>having high confidence in the wrong answer is really bad</em>). <strong>Objective: minimize</strong>.</p></li>
<li><p><strong>Gini index</strong>: Mainly used with tree-based methods and commonly referred to as a <em>measure of purity</em> where a small value indicates that <em>a node contains predominantly observations from a single class</em>. <strong>Objective: minimize</strong></p></li>
<li><p><strong>Confusion Matrix</strong>: Compares actual categorical levels (or events) to the predicted categorical levels</p></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="img/14-confution-matrix.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p>Some metrics related with the confusion matrix that need to be <strong>maximized</strong> are:</p>
<ul>
<li><ul>
<li>
<strong>Accuracy</strong>: Overall, how often is the classifier correct? Opposite of misclassification above. <span class="math inline">\(\frac{\text{TP} + \text{TN}}{N + P}\)</span>.</li>
<li>
<strong>Precision</strong>: For the <em>number of predictions</em> that we made, how many were correct? <span class="math inline">\(\frac{\text{TP}}{\text{TP} + \text{FP}}\)</span>.</li>
<li>
<strong>Sensitivity (aka recall)</strong>: For the <em>events</em> that occurred, how many did we predict? <span class="math inline">\(\frac{\text{TP}}{\text{TP} + \text{FN}}\)</span>.</li>
<li>
<strong>Specificity</strong>: How accurately does the classifier classify actual negative events? <span class="math inline">\(\frac{\text{TN}}{\text{TN} + \text{FP}}\)</span>.</li>
<li>
<strong>Area under the curve (AUC)</strong>: A good binary classifier will have high precision and sensitivity.To capture this balance, we often use a <em>ROC (receiver operating characteristics) curve</em> that plots the false positive rate along the x-axis and the true positive rate along the y-axis. A line that is diagonal from the lower left corner to the upper right corner represents a random guess. The higher the line is in the upper left-hand corner, the better. AUC computes the area under this curve.</li>
</ul></li>
</ul>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="img/15-ROC-curve.png" class="img-fluid figure-img"></p>
</figure>
</div>
<p>You can more metrics in the next table.</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure"><p><img src="img/14-confution-matrix-metrics.png" class="img-fluid figure-img"></p>
</figure>
</div>


</section></section></main><!-- /main --><script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script><nav class="page-navigation"><div class="nav-page nav-page-previous">
      <a href="./missing-values.html" class="pagination-link">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-number">2</span>&nbsp; <span class="chapter-title">Dealing with missingness</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="./resampling-methods.html" class="pagination-link">
        <span class="nav-page-text"><span class="chapter-number">4</span>&nbsp; <span class="chapter-title">Resampling methods</span></span> <i class="bi bi-arrow-right-short"></i>
      </a>
  </div>
</nav>
</div> <!-- /content -->
<footer class="footer"><div class="nav-footer">
    <div class="nav-footer-left">Non official solitions of An Introduction to Statistical Learning Second Edition</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">This book was built with <a href="https://quarto.org/">Quarto</a>.</div>
  </div>
</footer>


</body></html>